<!DOCTYPE html>
<html lang="en">
<head>
  <script>
    if (sessionStorage.getItem("authed") !== "1") { window.location.href = "index.html"; }
  </script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Valentine?</title>

  <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;600&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg1:#0b1020;
      --bg2:#0a1b33;
      --text: rgba(255,255,255,0.92);
      --muted: rgba(255,255,255,0.70);
      --pink:#ff7aa2;
    }

    *{ box-sizing: border-box; }
    html,body{ height:100%; }

    body{
      margin:0;
      min-height:100svh;
      min-height:100vh;
      display:grid;
      place-items:center;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--text);
      overflow:hidden;
      background:
        radial-gradient(900px 500px at 20% 15%, rgba(255,122,162,0.16), transparent 60%),
        radial-gradient(900px 500px at 80% 90%, rgba(120,190,255,0.12), transparent 60%),
        linear-gradient(180deg, var(--bg2), var(--bg1));
      padding: 24px;
    }

    .wrap{
      width: min(760px, 94vw);
      text-align:center;
      position: relative;
      z-index: 2;
    }

    .heart{
      width: 140px;
      height: 140px;
      margin: 0 auto 12px auto;
      position: relative;
      transform: rotate(-45deg);
      background: var(--pink);
      border-radius: 18px;
      box-shadow: 0 18px 60px rgba(0,0,0,0.45);
      animation: pulse 1.2s ease-in-out infinite;
    }
    .heart:before,
    .heart:after{
      content:"";
      position:absolute;
      width: 140px;
      height: 140px;
      background: var(--pink);
      border-radius: 50%;
    }
    .heart:before{ top: -70px; left: 0; }
    .heart:after{ left: 70px; top: 0; }

    @keyframes pulse{
      0%,100%{ transform: rotate(-45deg) scale(1); }
      50%{ transform: rotate(-45deg) scale(1.06); }
    }

    h1{
      font-family: Fraunces, serif;
      font-size: clamp(28px, 4.4vw, 44px);
      margin: 10px 0 18px 0;
      letter-spacing: -0.02em;
    }

    .btnRow{
      display:flex;
      justify-content:center;
      gap: 14px;
      margin-top: 10px;
      position: relative;
      height: 64px; /* room for the dodging button */
    }

    .btn{
      border:0;
      border-radius: 999px;
      padding: 12px 18px;
      font-weight: 900;
      cursor:pointer;
      font-size: 16px;
    }

    #yesBtn{
      background: var(--pink);
      color: #111;
      box-shadow: 0 14px 30px rgba(255,122,162,0.25);
    }

    /* No button is positioned so it can dodge */
    #noBtn{
      background: rgba(255,255,255,0.12);
      color: var(--text);
      border: 1px solid rgba(255,255,255,0.18);
      position: absolute;
      left: 55%;
      top: 0;
      transform: translateX(-50%);
      backdrop-filter: blur(8px);
    }

    .hint{
      margin-top: 10px;
      color: var(--muted);
      font-size: 13px;
    }

    /* Confetti canvas */
    #confetti{
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 5;
    }

    .msg{
      margin-top: 14px;
      font-weight: 800;
      opacity: 0;
      transform: translateY(6px);
      transition: 250ms ease;
    }

    .msg.show{
      opacity: 1;
      transform: translateY(0);
    }
  </style>
</head>
<body>

  <canvas id="confetti"></canvas>

  <main class="wrap">
    <div class="heart" aria-hidden="true"></div>
    <h1>will you be my valentine?</h1>

    <div class="btnRow" id="btnRow">
      <button class="btn" id="yesBtn" type="button">Yes</button>
      <button class="btn" id="noBtn" type="button">No</button>
    </div>

    <div class="msg" id="msg">YAYYYYYY üíñüíñüíñ</div>
    <div class="hint">(try clicking ‚ÄúNo‚Äù üòá)</div>
  </main>

  <script>
    (function(){
      // --- Make "No" dodge the cursor ---
      const noBtn = document.getElementById("noBtn");
      const row = document.getElementById("btnRow");

      function dodge(){
        const rowRect = row.getBoundingClientRect();
        const btnRect = noBtn.getBoundingClientRect();

        const maxX = rowRect.width - btnRect.width;
        const maxY = rowRect.height - btnRect.height;

        const x = Math.random() * Math.max(0, maxX);
        const y = Math.random() * Math.max(0, maxY);

        noBtn.style.left = x + "px";
        noBtn.style.top = y + "px";
        noBtn.style.transform = "none";
      }

      // Trigger on hover & on approach (pointermove)
      noBtn.addEventListener("mouseenter", dodge);
      row.addEventListener("pointermove", (e) => {
        const b = noBtn.getBoundingClientRect();
        const dx = e.clientX - (b.left + b.width/2);
        const dy = e.clientY - (b.top + b.height/2);
        const dist = Math.sqrt(dx*dx + dy*dy);
        if (dist < 90) dodge();
      });

      // --- Confetti on "Yes" ---
      const yesBtn = document.getElementById("yesBtn");
      const canvas = document.getElementById("confetti");
      const ctx = canvas.getContext("2d");
      const msg = document.getElementById("msg");

      function resize(){
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      }
      window.addEventListener("resize", resize);
      resize();

      function blastConfetti(){
        const N = 220;
        const parts = [];
        const W = canvas.width, H = canvas.height;

        for (let i=0;i<N;i++){
          parts.push({
            x: W/2 + (Math.random()-0.5)*40,
            y: H/3 + (Math.random()-0.5)*20,
            vx: (Math.random()-0.5)*10,
            vy: (Math.random()-1.1)*12,
            g: 0.22 + Math.random()*0.10,
            r: 3 + Math.random()*4,
            a: 0,
            va: (Math.random()-0.5)*0.25,
            life: 180 + Math.random()*80
          });
        }

        let t = 0;
        function frame(){
          t++;
          ctx.clearRect(0,0,canvas.width,canvas.height);

          for (const p of parts){
            p.vy += p.g;
            p.x += p.vx;
            p.y += p.vy;
            p.a += p.va;
            p.life--;

            // simple rectangles as confetti (no hard-coded colors? -> use HSL random)
            const hue = (p.x + p.y) % 360;
            ctx.save();
            ctx.translate(p.x, p.y);
            ctx.rotate(p.a);
            ctx.fillStyle = `hsl(${hue}, 90%, 65%)`;
            ctx.fillRect(-p.r, -p.r, p.r*2.2, p.r*1.6);
            ctx.restore();
          }

          const alive = parts.some(p => p.life > 0 && p.y < canvas.height + 40);
          if (alive) requestAnimationFrame(frame);
          else ctx.clearRect(0,0,canvas.width,canvas.height);
        }
        requestAnimationFrame(frame);
      }

      yesBtn.addEventListener("click", () => {
        blastConfetti();
        msg.classList.add("show");
      });
    })();
  </script>

</body>
</html>
